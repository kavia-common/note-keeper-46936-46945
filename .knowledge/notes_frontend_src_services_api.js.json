{"is_source_file": true, "format": "JavaScript", "description": "This file provides API utility functions for a note-taking application, including handling real HTTP requests to a backend server or mocking API behavior for local development/testing. It defines functions for fetching, creating, updating, and deleting notes, with code to switch between real and mocked APIs based on environment variables.", "external_files": ["localStorage", "fetch"], "external_methods": ["localStorage.getItem", "localStorage.setItem", "JSON.stringify", "JSON.parse", "fetch"], "published": ["fetchNotes", "createNote", "patchNote", "removeNote"], "classes": [], "methods": [{"name": "toError(err, fallbackMessage = \"Unexpected error\")", "description": "Normalizes various error types into a consistent Error object, optionally including cause information.", "scope": "", "scopeKind": ""}, {"name": "http(method, path, body)", "description": "Performs an HTTP request with fetch, handling JSON serialization/deserialization, and error handling based on response status.", "scope": "", "scopeKind": ""}, {"name": "delay(ms)", "description": "Creates a promise that resolves after a specified number of milliseconds to simulate latency.", "scope": "", "scopeKind": ""}, {"name": "readStore()", "description": "Reads the mock notes store from local storage, initializing it with default seed data if necessary.", "scope": "", "scopeKind": ""}, {"name": "writeStore(notes)", "description": "Writes the current notes array to local storage.", "scope": "", "scopeKind": ""}, {"name": "generateId()", "description": "Generates a unique ID string based on current timestamp and a random component.", "scope": "", "scopeKind": ""}, {"name": "createRealApi()", "description": "Constructs the API client that interacts with a real backend server via fetch calls.", "scope": "", "scopeKind": ""}, {"name": "createMockApi()", "description": "Constructs the API client that simulates server interactions using local storage and in-memory data.", "scope": "", "scopeKind": ""}, {"name": "create(payload)", "scope": "mockRepo", "scopeKind": "class", "description": "unavailable"}, {"name": "createNote(payload)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "fetchNotes()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "list()", "scope": "mockRepo", "scopeKind": "class", "description": "unavailable"}, {"name": "patch(id, payload)", "scope": "mockRepo", "scopeKind": "class", "description": "unavailable"}, {"name": "patchNote(id, payload)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "remove(id)", "scope": "mockRepo", "scopeKind": "class", "description": "unavailable"}, {"name": "removeNote(id)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["fetch", "localStorage.getItem", "localStorage.setItem", "JSON.stringify", "JSON.parse", "setTimeout"], "search-terms": ["API_BASE", "VITE_API_MOCK_LATENCY", "notes_frontend", "notes_mock_store_v1", "mockRepo", "fetchNotes", "createNote", "patchNote", "removeNote"], "state": 2, "file_id": 42, "knowledge_revision": 85, "git_revision": "", "ctags": [{"_type": "tag", "name": "API_BASE", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^const API_BASE = import.meta?.env?.VITE_API_BASE;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "DEFAULT_SEED", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^const DEFAULT_SEED = [$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "LS_KEY", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^const LS_KEY = \"notes_mock_store_v1\";$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "MOCK_LATENCY", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^const MOCK_LATENCY = Number(import.meta?.env?.VITE_API_MOCK_LATENCY || 300);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "api", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^const api = isRealApi ? createRealApi() : createMockApi();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "content", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^      content: payload?.content ?? \"\",$/", "language": "JavaScript", "kind": "property", "scope": "mockRepo.create.newNote", "scopeKind": "class"}, {"_type": "tag", "name": "create", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^  async create(payload) {$/", "language": "JavaScript", "kind": "method", "signature": "(payload)", "scope": "mockRepo", "scopeKind": "class"}, {"_type": "tag", "name": "createMockApi", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^function createMockApi() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "createNote", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^export async function createNote(payload) {$/", "language": "JavaScript", "kind": "function", "signature": "(payload)"}, {"_type": "tag", "name": "createRealApi", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^function createRealApi() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "createdAt", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^      createdAt: now,$/", "language": "JavaScript", "kind": "property", "scope": "mockRepo.create.newNote", "scopeKind": "class"}, {"_type": "tag", "name": "delay", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^function delay(ms) {$/", "language": "JavaScript", "kind": "function", "signature": "(ms)"}, {"_type": "tag", "name": "fetchNotes", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^export async function fetchNotes() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "generateId", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^function generateId() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "http", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^async function http(method, path, body) {$/", "language": "JavaScript", "kind": "function", "signature": "(method, path, body)"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^      id: generateId(),$/", "language": "JavaScript", "kind": "property", "scope": "mockRepo.create.newNote", "scopeKind": "class"}, {"_type": "tag", "name": "isRealApi", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^const isRealApi = typeof API_BASE === \"string\" && API_BASE.trim().length > 0;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "list", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^  async list() {$/", "language": "JavaScript", "kind": "method", "signature": "()", "scope": "mockRepo", "scopeKind": "class"}, {"_type": "tag", "name": "method", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^    method,$/", "language": "JavaScript", "kind": "field", "scope": "http.init", "scopeKind": "class"}, {"_type": "tag", "name": "mockRepo", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^const mockRepo = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "newNote", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^    const newNote = {$/", "language": "JavaScript", "kind": "class", "scope": "mockRepo.create", "scopeKind": "class"}, {"_type": "tag", "name": "patch", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^  async patch(id, payload) {$/", "language": "JavaScript", "kind": "method", "signature": "(id, payload)", "scope": "mockRepo", "scopeKind": "class"}, {"_type": "tag", "name": "patchNote", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^export async function patchNote(id, payload) {$/", "language": "JavaScript", "kind": "function", "signature": "(id, payload)"}, {"_type": "tag", "name": "readStore", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^function readStore() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "remove", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^  async remove(id) {$/", "language": "JavaScript", "kind": "method", "signature": "(id)", "scope": "mockRepo", "scopeKind": "class"}, {"_type": "tag", "name": "removeNote", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^export async function removeNote(id) {$/", "language": "JavaScript", "kind": "function", "signature": "(id)"}, {"_type": "tag", "name": "title", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^      title: payload?.title ?? \"Untitled\",$/", "language": "JavaScript", "kind": "property", "scope": "mockRepo.create.newNote", "scopeKind": "class"}, {"_type": "tag", "name": "toError", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^function toError(err, fallbackMessage = \"Unexpected error\") {$/", "language": "JavaScript", "kind": "function", "signature": "(err, fallbackMessage = \"Unexpected error\")"}, {"_type": "tag", "name": "updatedAt", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^      updatedAt: now,$/", "language": "JavaScript", "kind": "property", "scope": "mockRepo.create.newNote", "scopeKind": "class"}, {"_type": "tag", "name": "writeStore", "path": "/home/kavia/workspace/code-generation/note-keeper-46936-46945/notes_frontend/src/services/api.js", "pattern": "/^function writeStore(notes) {$/", "language": "JavaScript", "kind": "function", "signature": "(notes)"}], "hash": "fa4e7e3ba7afc059293cdecd959355c1", "format-version": 4, "code-base-name": "notes_frontend", "filename": "notes_frontend/src/services/api.js", "fields": [{"name": "content: payload?.content ?? \"\",", "scope": "mockRepo.create.newNote", "scopeKind": "class", "description": "unavailable"}, {"name": "createdAt: now,", "scope": "mockRepo.create.newNote", "scopeKind": "class", "description": "unavailable"}, {"name": "id: generateId(),", "scope": "mockRepo.create.newNote", "scopeKind": "class", "description": "unavailable"}, {"name": "method,", "scope": "http.init", "scopeKind": "class", "description": "unavailable"}, {"name": "title: payload?.title ?? \"Untitled\",", "scope": "mockRepo.create.newNote", "scopeKind": "class", "description": "unavailable"}, {"name": "updatedAt: now,", "scope": "mockRepo.create.newNote", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"85": ""}]}